---
title: "The Ridge Regression"
author: "Qi Tan"
output: html_document
---

<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{The ridge regression vignette}
-->

## The ridge regression

```{r}
library(bis557)
data(ridge_train)
data(ridge_test)

#Predict fitted value
predict.ridge_reg <- function(object, ...) {
  newdata <- list(...)[[1]] #Give the actual objects
  m <- model.matrix(object$formula, newdata)
  m %*% object$coefficients
}

lambda_seq <- seq(0, 1000, by=1)
mse <- rep(NA, length(lambda_seq))
result <- data.frame(cbind(lambda_seq, mse))

#Calculate mse
for (i in 1:length(result$mse)) {
  fit <- ridge_reg(y~., result$lambda_seq[i], ridge_train)
  error <- ridge_train$y - predict.ridge_reg(fit, ridge_test)
  result$mse[i] <- mean(error^2)
}

#Select log_lambda
result$log_lambda <- log(result$lambda_seq)
result$log_lambda[result$mse==min(result$mse)]
```
